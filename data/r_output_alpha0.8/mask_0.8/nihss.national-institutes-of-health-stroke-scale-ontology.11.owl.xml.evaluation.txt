Initial masked cEmb MSE loss: [[0.00000000e+00 4.87353984e-03 2.72737165e-03 ... 2.15768532e-03
  6.30942888e-05 3.42089273e-03]
 [1.78479948e-03 4.24172661e-03 2.98279067e-04 ... 0.00000000e+00
  1.28522038e-03 2.31805473e-04]
 [0.00000000e+00 3.48983784e-04 4.01354704e-03 ... 3.42433022e-04
  2.22490559e-03 1.17233063e-03]
 ...
 [1.34278672e-05 0.00000000e+00 0.00000000e+00 ... 1.66660844e-03
  1.56378046e-04 1.92453663e-03]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
  0.00000000e+00 0.00000000e+00]]
Initial masked rEmb MSE loss: [[[0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  [3.27528419e-03 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  ...
  [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]]

 [[0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  ...
  [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 7.98785917e-04
   0.00000000e+00 0.00000000e+00]]

 [[0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  ...
  [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]]

 ...

 [[0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  ...
  [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]]

 [[0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  ...
  [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 2.71061876e-05
   0.00000000e+00 0.00000000e+00]]

 [[0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  ...
  [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]
  [1.48644991e-03 0.00000000e+00 2.75795314e-03 ... 0.00000000e+00
   0.00000000e+00 0.00000000e+00]]]
loss: 0.0
After training: [[1.18073570e-04 4.87353984e-03 1.18212833e-03 ... 2.15768532e-03
  6.30942888e-05 3.42089273e-03]
 [1.78479948e-03 4.24172661e-03 2.98279067e-04 ... 2.85659392e-04
  1.28522038e-03 4.14147641e-04]
 [1.18073570e-04 3.48983784e-04 4.01354704e-03 ... 6.46857692e-04
  2.22490559e-03 2.11966466e-04]
 ...
 [1.57288460e-04 0.00000000e+00 3.71013273e-03 ... 1.66660844e-03
  1.56378046e-04 2.10509905e-03]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 0.00000000e+00
  0.00000000e+00 0.00000000e+00]]
After training: [[[3.06473199e-03 9.01642848e-08 3.07412614e-03 ... 3.06473199e-03
   3.06473199e-03 3.06473199e-03]
  [1.81320642e-02 5.63159081e-04 5.63238197e-04 ... 5.99467008e-03
   5.99467008e-03 5.99467008e-03]
  [2.80901295e-04 8.50721252e-05 2.95025810e-03 ... 2.93160257e-03
   2.93160257e-03 2.93160257e-03]
  ...
  [8.78432309e-05 9.01545583e-08 9.01545583e-08 ... 8.78432309e-05
   8.78432309e-05 8.78432309e-05]
  [2.68502452e-03 9.01642248e-08 9.01642248e-08 ... 2.68502452e-03
   2.68502452e-03 2.68502452e-03]
  [1.57975290e-06 8.99956309e-08 8.99956309e-08 ... 1.57975290e-06
   1.57975290e-06 1.57975290e-06]]

 [[4.97702126e-04 1.89658889e-03 3.06473199e-03 ... 3.07412614e-03
   3.06473199e-03 3.06473199e-03]
  [5.60657361e-04 5.60761941e-04 5.99467008e-03 ... 6.00836604e-03
   5.99467008e-03 5.99467008e-03]
  [9.01642783e-08 9.01642783e-08 2.93160257e-03 ... 2.94073771e-03
   2.93160257e-03 2.93160257e-03]
  ...
  [1.89268527e-04 1.89277383e-04 1.90696122e-04 ... 1.89705873e-04
   1.90454267e-04 1.90427998e-04]
  [9.01642248e-08 9.01642248e-08 2.68502452e-03 ... 2.69370499e-03
   2.68502452e-03 2.68502452e-03]
  [8.99956309e-08 8.99956309e-08 1.57975290e-06 ... 7.98785917e-04
   1.57975290e-06 1.57975290e-06]]

 [[5.31860236e-04 3.06473199e-03 2.53309495e-03 ... 3.07412614e-03
   3.06473199e-03 3.06473199e-03]
  [6.00836604e-03 5.99467008e-03 6.00836604e-03 ... 6.00836604e-03
   5.99467008e-03 5.99467008e-03]
  [7.37600883e-05 2.93160257e-03 1.43542666e-03 ... 2.94073771e-03
   2.93160257e-03 2.93160257e-03]
  ...
  [1.12931591e-07 8.78432309e-05 6.76866568e-05 ... 9.00289239e-05
   8.78432309e-05 8.78432309e-05]
  [9.01642248e-08 2.68502452e-03 9.01642248e-08 ... 2.69370499e-03
   2.68502452e-03 2.68502452e-03]
  [8.99956309e-08 1.57975290e-06 8.99956309e-08 ... 8.99956309e-08
   1.57975290e-06 1.57975290e-06]]

 ...

 [[4.42699614e-04 2.59071110e-03 3.07412614e-03 ... 3.07412614e-03
   3.07412614e-03 3.07412614e-03]
  [5.77919032e-04 5.77918884e-04 6.00836604e-03 ... 6.00836604e-03
   6.00836604e-03 6.00836604e-03]
  [6.05289121e-05 6.05290708e-05 2.95025810e-03 ... 2.94073771e-03
   2.94073771e-03 2.94073771e-03]
  ...
  [1.16306411e-07 6.76866568e-05 7.21088339e-05 ... 9.00289239e-05
   5.18608131e-07 8.89021255e-05]
  [2.52699731e-05 2.52705397e-05 1.36454976e-03 ... 2.69370499e-03
   2.70275444e-03 2.69370499e-03]
  [9.03485020e-08 1.71514597e-06 8.99956309e-08 ... 8.99956309e-08
   8.99956309e-08 1.71514597e-06]]

 [[4.78490658e-04 3.06473199e-03 2.43330523e-03 ... 3.06473199e-03
   3.07412614e-03 3.06473199e-03]
  [6.00836604e-03 5.99467008e-03 6.00836604e-03 ... 5.99467008e-03
   6.00836604e-03 5.99467008e-03]
  [7.64541265e-05 2.93160257e-03 1.43542666e-03 ... 2.93160257e-03
   2.94073771e-03 2.93160257e-03]
  ...
  [9.01545583e-08 8.78432309e-05 9.01545583e-08 ... 8.78432309e-05
   9.01545583e-08 8.78432309e-05]
  [2.40504770e-05 2.68502452e-03 1.32606318e-03 ... 2.68502452e-03
   2.70275444e-03 2.68502452e-03]
  [8.99956309e-08 1.57975290e-06 8.99956309e-08 ... 1.55983771e-05
   8.99956309e-08 1.57975290e-06]]

 [[5.08983697e-04 3.06473199e-03 3.06473199e-03 ... 3.07412614e-03
   3.07412614e-03 3.06473199e-03]
  [6.00836604e-03 5.99467008e-03 5.99467008e-03 ... 6.00836604e-03
   6.00836604e-03 5.99467008e-03]
  [9.01642783e-08 2.93160257e-03 2.93160257e-03 ... 2.94073771e-03
   2.94073771e-03 2.93160257e-03]
  ...
  [1.71180203e-07 8.78432309e-05 8.78432309e-05 ... 9.00289239e-05
   5.02829967e-07 8.78432309e-05]
  [2.02658708e-04 2.68502452e-03 2.68502452e-03 ... 2.69370499e-03
   2.70275444e-03 2.68502452e-03]
  [1.48644991e-03 1.57975290e-06 2.75795314e-03 ... 8.99956309e-08
   8.99956309e-08 1.57975290e-06]]]
